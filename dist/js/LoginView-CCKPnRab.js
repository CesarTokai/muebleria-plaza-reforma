var g=(S,u,c)=>new Promise((b,m)=>{var l=r=>{try{n(c.next(r))}catch(y){m(y)}},a=r=>{try{n(c.throw(r))}catch(y){m(y)}},n=r=>r.done?b(r.value):Promise.resolve(r.value).then(l,a);n((c=c.apply(S,u)).next())});import{s as p,g as i,h as e,m as f,G as k,a as x,J as w,i as o,L as q,O as I,p as R,w as C,T as V,u as T,o as t,t as P}from"./vendor-vue-Bh9miRvp.js";import{a as _}from"./AxiosConfig-Dd5pkUAe.js";import{_ as $}from"./_plugin-vue_export-helper-DlAUqK2U.js";const B={class:"login-container"},D={key:0,class:"login-brand"},h={class:"form-body"},z={class:"form-group"},O={class:"form-group"},A={class:"password-wrapper"},G=["type"],J={key:0,class:"login-error"},j=["disabled"],F={key:0},H={key:1,class:"loading-spinner"},K={class:"form-body"},Q={class:"form-group"},W={key:0,class:"login-error"},X=["disabled"],Y={key:0},Z={key:1,class:"loading-spinner"},ee={class:"form-body"},se={class:"form-group"},le={key:0,class:"login-error"},ae=["disabled"],ie={key:0},oe={key:1,class:"loading-spinner"},te={class:"form-body"},re={class:"form-group"},ne={class:"password-wrapper"},de=["type"],ue={key:0,class:"login-error"},ve=["disabled"],ce={key:0},pe={key:1,class:"loading-spinner"},be={__name:"LoginView",setup(S){const u=p(""),c=p(""),b=p(""),m=p(""),l=p(""),a=p(!1),n=p(0),r=p(!1),y=T();function E(){return g(this,null,function*(){l.value="",a.value=!0;try{const v=yield _.doPost("/login",{email:u.value,password:c.value});v.data&&(v.data.token||v.data.access_token)?(localStorage.setItem("token",v.data.token||v.data.access_token),localStorage.setItem("role","admin"),y.push("/admin")):l.value="Credenciales incorrectas"}catch(v){l.value="Usuario o contraseña incorrectos"}finally{a.value=!1}})}function N(){n.value=1,l.value=""}function U(){return g(this,null,function*(){l.value="",a.value=!0;try{yield _.doPost("/request-reset",{email:u.value}),n.value=2}catch(v){l.value="Error al enviar el código de verificación"}finally{a.value=!1}})}function M(){return g(this,null,function*(){l.value="",a.value=!0;try{yield _.doPost("/verify-code",{email:u.value,code:b.value}),n.value=3}catch(v){l.value="Código de verificación incorrecto"}finally{a.value=!1}})}function L(){return g(this,null,function*(){l.value="",a.value=!0;try{yield _.doPost("/reset-password",{email:u.value,code:b.value,new_password:m.value}),n.value=0,alert("Contraseña restablecida con éxito")}catch(v){l.value="Error al restablecer la contraseña"}finally{a.value=!1}})}return(v,s)=>(t(),i("div",B,[s[35]||(s[35]=e("div",{class:"background-decoration"},[e("div",{class:"shape shape-1"}),e("div",{class:"shape shape-2"}),e("div",{class:"shape shape-3"})],-1)),n.value?f("",!0):(t(),i("div",D,[...s[9]||(s[9]=[e("div",{class:"brand-icon"},[e("i",{class:"bi bi-shop"})],-1),e("h1",null,"Mueblería Plaza Reforma",-1),e("p",null,"Panel de Administración",-1)])])),n.value?n.value===1?(t(),i("form",{key:2,class:"login-form",onSubmit:k(U,["prevent"])},[e("button",{type:"button",class:"back-btn",onClick:s[3]||(s[3]=d=>n.value=0)},[...s[17]||(s[17]=[e("i",{class:"bi bi-arrow-left"},null,-1)])]),s[22]||(s[22]=e("div",{class:"form-header"},[e("div",{class:"icon-circle"},[e("i",{class:"bi bi-key"})]),e("h2",null,"Restablecer contraseña"),e("p",null,"Ingresa tu correo para recibir el código")],-1)),e("div",K,[e("div",Q,[s[18]||(s[18]=e("label",{for:"reset-email"},[e("i",{class:"bi bi-envelope"}),o(" Correo electrónico ")],-1)),w(e("input",{"onUpdate:modelValue":s[4]||(s[4]=d=>u.value=d),id:"reset-email",type:"email",placeholder:"tu@email.com",required:""},null,512),[[q,u.value]])]),x(V,{name:"error"},{default:C(()=>[l.value?(t(),i("div",W,[s[19]||(s[19]=e("i",{class:"bi bi-exclamation-circle"},null,-1)),o(" "+P(l.value),1)])):f("",!0)]),_:1}),e("button",{type:"submit",class:"btn-primary",disabled:a.value},[a.value?(t(),i("span",Z,[...s[21]||(s[21]=[e("i",{class:"bi bi-arrow-repeat spin"},null,-1),o(" Enviando... ",-1)])])):(t(),i("span",Y,[...s[20]||(s[20]=[e("i",{class:"bi bi-send"},null,-1),o(" Enviar código ",-1)])]))],8,X)])],32)):n.value===2?(t(),i("form",{key:3,class:"login-form",onSubmit:k(M,["prevent"])},[e("button",{type:"button",class:"back-btn",onClick:s[5]||(s[5]=d=>n.value=1)},[...s[23]||(s[23]=[e("i",{class:"bi bi-arrow-left"},null,-1)])]),s[28]||(s[28]=e("div",{class:"form-header"},[e("div",{class:"icon-circle"},[e("i",{class:"bi bi-shield-check"})]),e("h2",null,"Verificar código"),e("p",null,"Revisa tu correo e ingresa el código")],-1)),e("div",ee,[e("div",se,[s[24]||(s[24]=e("label",{for:"code"},[e("i",{class:"bi bi-123"}),o(" Código de verificación ")],-1)),w(e("input",{"onUpdate:modelValue":s[6]||(s[6]=d=>b.value=d),id:"code",type:"text",placeholder:"000000",required:"",class:"code-input"},null,512),[[q,b.value]])]),x(V,{name:"error"},{default:C(()=>[l.value?(t(),i("div",le,[s[25]||(s[25]=e("i",{class:"bi bi-exclamation-circle"},null,-1)),o(" "+P(l.value),1)])):f("",!0)]),_:1}),e("button",{type:"submit",class:"btn-primary",disabled:a.value},[a.value?(t(),i("span",oe,[...s[27]||(s[27]=[e("i",{class:"bi bi-arrow-repeat spin"},null,-1),o(" Verificando... ",-1)])])):(t(),i("span",ie,[...s[26]||(s[26]=[e("i",{class:"bi bi-check-circle"},null,-1),o(" Verificar ",-1)])]))],8,ae)])],32)):n.value===3?(t(),i("form",{key:4,class:"login-form",onSubmit:k(L,["prevent"])},[s[34]||(s[34]=e("div",{class:"form-header"},[e("div",{class:"icon-circle success"},[e("i",{class:"bi bi-lock-fill"})]),e("h2",null,"Nueva contraseña"),e("p",null,"Crea una contraseña segura")],-1)),e("div",te,[e("div",re,[s[29]||(s[29]=e("label",{for:"new-password"},[e("i",{class:"bi bi-shield-lock"}),o(" Nueva contraseña ")],-1)),e("div",ne,[w(e("input",{"onUpdate:modelValue":s[7]||(s[7]=d=>m.value=d),id:"new-password",type:r.value?"text":"password",placeholder:"••••••••",required:"",minlength:"6"},null,8,de),[[I,m.value]]),e("button",{type:"button",class:"toggle-password",onClick:s[8]||(s[8]=d=>r.value=!r.value),tabindex:"-1"},[e("i",{class:R(r.value?"bi bi-eye-slash":"bi bi-eye")},null,2)])]),s[30]||(s[30]=e("small",{class:"help-text"},"Mínimo 6 caracteres",-1))]),x(V,{name:"error"},{default:C(()=>[l.value?(t(),i("div",ue,[s[31]||(s[31]=e("i",{class:"bi bi-exclamation-circle"},null,-1)),o(" "+P(l.value),1)])):f("",!0)]),_:1}),e("button",{type:"submit",class:"btn-primary",disabled:a.value},[a.value?(t(),i("span",pe,[...s[33]||(s[33]=[e("i",{class:"bi bi-arrow-repeat spin"},null,-1),o(" Procesando... ",-1)])])):(t(),i("span",ce,[...s[32]||(s[32]=[e("i",{class:"bi bi-check-circle"},null,-1),o(" Restablecer ",-1)])]))],8,ve)])],32)):f("",!0):(t(),i("form",{key:1,class:"login-form",onSubmit:k(E,["prevent"])},[s[16]||(s[16]=e("div",{class:"form-header"},[e("h2",null,"Iniciar sesión"),e("p",null,"Ingresa tus credenciales para continuar")],-1)),e("div",h,[e("div",z,[s[10]||(s[10]=e("label",{for:"email"},[e("i",{class:"bi bi-envelope"}),o(" Correo electrónico ")],-1)),w(e("input",{"onUpdate:modelValue":s[0]||(s[0]=d=>u.value=d),id:"email",type:"email",placeholder:"tu@email.com",required:"",autocomplete:"username"},null,512),[[q,u.value]])]),e("div",O,[s[11]||(s[11]=e("label",{for:"password"},[e("i",{class:"bi bi-lock"}),o(" Contraseña ")],-1)),e("div",A,[w(e("input",{"onUpdate:modelValue":s[1]||(s[1]=d=>c.value=d),id:"password",type:r.value?"text":"password",placeholder:"••••••••",required:"",autocomplete:"current-password"},null,8,G),[[I,c.value]]),e("button",{type:"button",class:"toggle-password",onClick:s[2]||(s[2]=d=>r.value=!r.value),tabindex:"-1"},[e("i",{class:R(r.value?"bi bi-eye-slash":"bi bi-eye")},null,2)])])]),x(V,{name:"error"},{default:C(()=>[l.value?(t(),i("div",J,[s[12]||(s[12]=e("i",{class:"bi bi-exclamation-circle"},null,-1)),o(" "+P(l.value),1)])):f("",!0)]),_:1}),e("button",{type:"submit",class:"btn-primary",disabled:a.value},[a.value?(t(),i("span",H,[...s[14]||(s[14]=[e("i",{class:"bi bi-arrow-repeat spin"},null,-1),o(" Ingresando... ",-1)])])):(t(),i("span",F,[...s[13]||(s[13]=[e("i",{class:"bi bi-box-arrow-in-right"},null,-1),o(" Entrar ",-1)])]))],8,j),e("button",{type:"button",class:"reset-password-btn",onClick:N},[...s[15]||(s[15]=[e("i",{class:"bi bi-question-circle"},null,-1),o(" ¿Olvidaste tu contraseña? ",-1)])])])],32))]))}},we=$(be,[["__scopeId","data-v-18192963"]]);export{we as default};
